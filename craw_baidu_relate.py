import requests, csv, time, random
from lxml import html
from multiprocessing.dummy import Pool

headers = {
    "User-Agent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36"
}

base_url = 'http://www.baidu.com/s?wd={}'

all_relate_search_data = list()

def save():
    writer = csv.DictWriter(f=open('baidu_relate_search.csv', 'w', encoding='utf-8', newline=''),
                            fieldnames=['keyword', 'relate'])
    writer.writeheader()

    writer.writerows(all_relate_search_data)


def craw_relate(search_word):
    search_url = base_url.format(search_word)
    try:
        res = requests.get(search_url, headers=headers)

        if res.status_code == 200:
            selector = html.fromstring(res.text)
        else:
            craw_relate(search_word)
    except:
        craw_relate(search_word)
        time.sleep(random.randint(8, 8))
    else:
            relate_search_info = selector.xpath("//div[@id='rs']/table//th/a/text()")

            relate_search_data = {'keyword': search_word, 'relate': '，'.join(relate_search_info)}
            all_relate_search_data.append(relate_search_data)
            print(relate_search_data)
            time.sleep(random.randint(3, 5))


if __name__ == '__main__':
    keywords = """
个人所得税
个人所得税计算器
增值税专用发票
个人所得税税率表
增值税
营改增
发票
个税
纳税人识别号
一般纳税人
印花税
车船税
增值税普通发票
增值税发票
个税税率表
电子发票
企业所得税
个人所得税计算方法
小规模纳税人
车船税新标准
个税税率
小规模纳税人和一般纳税人的区别
增值税税率
金税盘
工资扣税标准
个人所得税计算
金税三期
增值税发票和普通发票的区别
出口退税
遗产税
一般纳税人和小规模纳税人的区别
营改增是什么意思
车船税每年都要交吗
土地增值税
发票抬头是什么意思
税务登记证
企业所得税计算方法
企业所得税税率
退税
年终奖个人所得税计算方法
所得税
所得税计算方法
滞纳金
小规模纳税人如何报税
印花税税率
消费税
定额发票
个人所得税起征点
发票抬头
增值税普通发票和专用发票的区别
个体户怎么交税
车船使用税
税率
税务登记证号
土地使用税
税务
进项税额转出会计分录
印花税怎么算
纳税申报
普通发票和增值税发票的区别
红字发票
一般纳税人认定标准
企业所得税法
年终奖个人所得税计算器
个人所得税税率
残保金
进项税额转出
关税
一般纳税人查询
印花税税目税率表
残保金如何计算
营业税改增值税
税收征管法
小规模纳税人税率
营改增范围
个人所得税法
小微企业所得税优惠政策
税收征收管理法
餐饮发票
税前工资计算器
速算扣除数
完税证明
递延所得税
发票管理办法
税务咨询
息税前利润
耕地占用税
税收
劳务费税率
形式发票
报税流程
网上报税
定额
纳税人识别号查询
土地增值税计算方法
发票专用章
网络发票
应纳税所得额
印花税是什么
税后工资
遗产税如何征收
滞纳金是什么意思
营改增税率表
纳税
劳务报酬个人所得税
税务登记
报税
土地使用税如何计算
流转税
增值税暂行条例
城建税
开票信息
税率表
滞纳金怎么算
税率计算公式
增值税纳税申报表
企业所得税法实施条例
税控发票
城镇土地使用税
教育费附加
一般纳税人报税流程
纳税人
增值税抵扣
营改增最新政策
营改增税率
企业所得税汇算清缴
发票种类
税负
个人所得税计算公式
住宿发票
合理避税
资源税
税负率怎么算
网上报税流程
高新技术企业税收优惠
文化事业建设费
土地增值税税率
个体工商户税收
城市维护建设税
汇算清缴
退税率查询
进项税转出
开票
营业税和增值税的区别
个人所得税率
完税价格
国税发票
小规模纳税人账务处理
职工福利费税前扣除标准
股权转让个人所得税
股票印花税
进口车关税
主营业务税金及附加
开票资料
进口关税
增值税专用发票和增值税普通发票的区别
偷税
增值税一般纳税人
税负率
税票
消费税的计算
消费税税率
房屋租赁发票
汽车消费税
个税计算方法
逃税罪
排量税
纳税人识别码
发票认证
城建税税率
年终奖扣税
一般纳税人资格认定
捐赠支出税前扣除标准
税种
增值税专用发票抵扣
教育费附加税率
纳税申报表
税务筹划
避税
增值税的会计核算
印花税暂行条例
税负是什么意思
税控机
流转税包括哪些
所得税汇算清缴时间
关税完税价格
车船税是什么
城建税及教育费附加税率
偷税漏税
招待费税前扣除标准
个人所得税怎么算
房租发票
纳税证明
建筑业营改增
个税计算公式
发票抬头怎么写
出口退税账务处理
小型微利企业所得税优惠政策
所得税汇算清缴分录
什么是增值税
增值税计算
农业税
外出经营活动税收管理证明
增值税暂行条例实施细则
离岛免税
营业外收入要交税吗
所得税汇算清缴
发票管理办法实施细则
个税改革
收据和发票的区别
税费
所得税税率
抄税
出口退税流程
税后工资计算
关税怎么算
运输发票
个人所得税申报
印花税票
二手房增值税
广告费税前扣除标准
房租发票税率
个调税
二手房个人所得税
税务登记管理办法
代扣代缴
报关的流程
企业所得税会计分录
职工教育经费税前扣除标准
劳务费个人所得税
工资税率
保税仓库
年终奖个人所得税
地方教育费附加税率
行邮税
税率怎么算
房贷利息抵扣个税
二手车交易税
红利税
出口退税率查询
报关流程
课税
税务稽查
营业税改征增值税试点实施办法
避税天堂
土地增值税清算
增值
车船税查询
起征点
出口转内销
税收征管法实施细则
什么是增值税发票
纳税证明怎么开
利税总额
增值税发票管理办法
分税制
外籍人员个人所得税
房产增值税
个人所得税完税证明
发票的种类
一般纳税人税率
超额累进税率
城市基础设施配套费
两税法
增值税税率表
退税怎么算
税收学
退税流程
手写发票
税收滞纳金
流转
报税是什么意思
税务专业
税务会计
纳税服务
一般纳税人资格
营改增的意义
报税怎么报
增值税专用发票使用规定
税收筹划
出口押汇
个税申报
个人所得税税率计算器
资源税税率
什么是营改增
福利费税前扣除标准
进口报关流程
代扣代缴个人所得税
消费税征收范围
企业所得税计算公式
年终奖个税
进口税
发票查验
逃税
增值税小规模纳税人
劳务报酬所得税率表
退税率
增值税条例
运输发票税率
进口汽车关税
出口退税率
增值税起征点
增值税票
个人所得税怎么计算
地方税
增值税专用发票认证
什么是印花税
价税合计
一般纳税人资格证书
税控
增值税发票税率
汽车关税
车船税怎么交
遗产税税率
餐饮业税率
所得税计算
不动产发票
纳税筹划
车购税
什么是一般纳税人
个税速算扣除数
烟草税
主营业务税金及附加包括哪些
印花税会计分录
所得税会计分录
房产个税
如何合理避税
增值税发票抵扣期限
海南免税
文化建设事业费
增值税发票抵扣
税收的作用
偷税罪
增值税发票认证
股票印花税怎么算
偶然所得税
税制改革
滞纳金计算器
资源税改革
个人所得税改革
出口报关流程
发票代码查询
一般纳税人认定
税收优惠政策
业务招待费税前扣除标准
二手房个税
房贷抵个税
城市建设维护税
财产税
进口关税查询
报税时间
税务行政复议
源泉扣缴
定额税
开票流程
定额发票有效期
税务发票
纳税评估
税收优惠
红字增值税专用发票
年终奖个税计算器
进口关税税率查询
增值税税负率
小型微利企业所得税税率
证券交易印花税
税改
直接税
税务登记证副本
货物运输业增值税专用发票
小型微利企业所得税
购销合同印花税税率
出口退税计算
燃油税
税种分类
增值税法
企业所得税率
奖金扣税
关税壁垒
关税税率
个人所得税如何计算
卷烟消费税
出口关税
残保金会计分录
分税制改革
增值税发票认证期限
个人偶然所得税
教育附加费
发票管理
变更税务登记表
直接税和间接税
税率计算
定期定额征收
全年一次性奖金个人所得税计算方法
残疾人就业保障金会计分录
借款合同印花税税率
免税收入
进出口退税
环境税
河道费
开票系统
税票怎么开
企业所得税申报表
印花税的计税依据
车船税减半
新税法
消费型增值税
工资税率表
税收滞纳金怎么算
漏税
减免税调查表
房地产营改增
购置税优惠
所得税计算公式
一般纳税人申请
个人所得税标准
股票交易印花税
纳税人识别码是什么
运输发票抵扣税率
结构性减税
服务业税率
所得税率
会务费发票
增值税小规模纳税人税率
个人所得税征收标准
出口报关单
出口收汇核销单
费改税
房屋个人所得税
土地使用税税率
负数发票
增值发票
保税货物
车辆购置税纳税申报表
进口关税怎么算
外贸出口退税
车船税法
申报表
税种核定
减税
个人所得税申报表
卖房个人所得税
申报纳税
增值税改革
企业所得税实施条例
印花税率
医疗发票
应税消费品
退税查询
进出口报关
土地闲置费
税收政策
税费计算
所得税法
合同印花税税率
发票联
小规模纳税人增值税账务处理
增值税税负
抗税罪
课税对象
小规模纳税人增值税
代扣代缴个人所得税会计分录
河道管理费
开票证明
税控收款机
个体工商户个人所得税税率表
租赁发票
运费税率
一般纳税人标准
税务知识
工程款发票
开增值税
企业增值税
进口关税税率
发票真假查询
防伪税控
协税员
征税
机票税费
最新税率表
营改增会计处理
建筑业发票
免税政策
发票遗失
进项税额转出分录
反补贴税
税款滞纳金
财税服务
汇算清缴报告
退税申请书
发票核销
做账报税
劳务报酬个人所得税计算方法
借款合同印花税
税收宣传月
企业所得税计算
委托加工应税消费品
账本印花税
发票样本
偷税漏税举报
劳务费税率表
个税算法
非关税壁垒
税务登记证年检
所得税分录
税票查询
税票是什么
减税政策
核定征收企业所得税
新个税税率表
发票专用章新规定
代扣代缴企业所得税
个人独资企业所得税
化妆品进口关税
一般纳税人辅导期
税务登记表
离境退税
税审
营改增实施细则
营改增账务处理
辅导期一般纳税人
企业所得税年度纳税申报表
个税起征
税务登记证遗失
税收征管
涉税服务
小微企业优惠政策
营业税改征增值税
税务登记证办理
堤围费
所得税申报表
一般纳税人认证
纳税人编码
物业税
基础设施配套费
逃避缴纳税款罪
税收痛苦指数
个体户交税
免税证明
小规模纳税人增值税税率
房屋租赁合同印花税
房产个人所得税
海关关税查询
税务登记证有效期
税收收入
报税系统
纳税人编码是什么
国税税种
减免税会计分录
营改增培训课件
外籍人员个人所得税税率表
小规模纳税人标准
开税票
所得税税负率
消费税税率表
公共事业费
个体工商户税率表
如何避税
如何计算个人所得税
年终奖税率
消费税组成计税价格
税务行政诉讼
年终奖个税计算
税务软件
高新技术企业优惠政策
企业所得税税率表
汇算清缴所得税会计分录
所得税季报
奢侈品关税
文化建设费
小规模纳税人申报表
税收基础知识
税负转嫁
纳税人代码
旅游业税率
消费税暂行条例
如何开增值税票
企业所得税核定征收
企业所得税税前扣除办法
汇算清缴怎么做
关税计算
增值税专用发票样本
个体工商户税收标准
抄税时间
企业所得税法实施细则
进口货物完税价格
工程款税率
滞纳金会计分录
契税优惠
关税税率查询
过头税
防伪税控开票系统
速算扣除数怎么算
企业所得税税前扣除
税务登记证注销
税收学专业
什么是纳税人识别号
什么是消费税
金税卡
先征后退
广告业税率
年终奖税率表
房产增值税如何征收
营业税 增值税
残保金计算
发票管理制度
增值税发票样本
所得税法实施条例
契税优惠政策
税审报告
一般纳税人账务处理
税务零申报
定额征收
矿产资源税
城市建设配套费
税务自查报告
高新技术企业税收优惠政策
企业所得税弥补亏损明细表
个体工商户如何纳税
中国税种
虚开增值税票
企业所得税实施细则
税务所的故事
税收违法违纪行为处分规定
税负怎么算
报关单填制
什么是税负
汽油消费税
房屋租赁印花税
税收相关法律
河道税
税务服务
账簿印花税
税率和征收率
成品油消费税
所得税纳税申报表
港口建设费
小规模转一般纳税人
适用税率
滞纳金计算
建筑安装税率
环境保护费
优化纳税服务
个体工商户所得税
年终奖怎么扣税
税务行政许可申请表
纳税人权利
免征增值税账务处理
交易印花税
税款滞纳金怎么算
年度汇算清缴
避税港
年终奖计税
河道费税率
新企业所得税法
年终汇算清缴
增资印花税
税控接口
最新个税税率表
发票流向
所得税汇算清缴会计分录
补充养老保险税前扣除
发票存根联保存期限
抗税
基础设施费
海域使用金
网络发票管理办法
季度所得税申报表
汽车购置税优惠
新增值税条例
营业税改征增值税试点有关企业会计处理规定
购置税优惠政策
全球税负痛苦指数
河道费会计分录
劳务所得税税率表
营业税与增值税的区别
增值税滞纳金怎么算
教育费附加会计分录
增值税发票丢失证明
企业所得税核定征收鉴定表
所得税申报
年终奖个税计算公式
基础设施建设费
残疾人保障金会计分录
进口增值税抵扣
差旅费税前扣除标准
发票挂失
车辆购置税优惠政策
服务行业税率
所得税清算
节税
汇算清缴会计分录
劳务费扣税
报税员
新增利税
内销补税
流转税包括
金华税案
营业税改征增值税试点方案
企业所得税季报
外资企业所得税
"""
    pool = Pool(10)
    pool.map(craw_relate, [i.strip() for i in keywords.strip().split("\n")])
    save()